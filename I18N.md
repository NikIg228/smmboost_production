# Документация по интернационализации (i18n)

## Обзор

Проект использует библиотеку **i18next** с интеграцией **react-i18next** для поддержки многоязычности. Реализована поддержка трех языков:
- **Русский (ru)** - язык по умолчанию
- **Английский (en)**
- **Казахский (kz)**

## Архитектура

### Структура файлов

```
src/
├── lib/
│   └── i18n.ts              # Конфигурация i18n
├── locales/
│   ├── ru.json              # Русские переводы
│   ├── en.json              # Английские переводы
│   └── kz.json              # Казахские переводы
└── main.tsx                 # Инициализация приложения
```

## Конфигурация i18n

### Файл: `src/lib/i18n.ts`

Основной файл конфигурации интернационализации:

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

import ruTranslations from '../locales/ru.json';
import kzTranslations from '../locales/kz.json';
import enTranslations from '../locales/en.json';

i18n
  .use(LanguageDetector)           // Автоопределение языка
  .use(initReactI18next)          // Интеграция с React
  .init({
    resources: {
      ru: { translation: ruTranslations },
      kz: { translation: kzTranslations },
      en: { translation: enTranslations }
    },
    fallbackLng: 'ru',            // Язык по умолчанию
    defaultNS: 'translation',      // Дефолтный namespace
    debug: false,                  // Режим отладки
    interpolation: {
      escapeValue: false          // Отключение экранирования HTML
    },
    detection: {
      order: ['localStorage', 'navigator'],  // Порядок определения языка
      caches: ['localStorage'],               // Кеширование в localStorage
      lookupLocalStorage: 'i18nextLng'       // Ключ в localStorage
    }
  });
```

### Ключевые настройки:

1. **LanguageDetector** - автоматически определяет язык пользователя:
   - Сначала проверяет `localStorage` (ключ `i18nextLng`)
   - Затем проверяет язык браузера (`navigator.language`)
   - Сохраняет выбранный язык в `localStorage`

2. **fallbackLng: 'ru'** - если перевод не найден, используется русский язык

3. **interpolation.escapeValue: false** - позволяет использовать HTML в переводах

## Инициализация

### Файл: `src/main.tsx`

i18n инициализируется при запуске приложения:

```typescript
import './lib/i18n';  // Импорт инициализирует i18n
```

Важно: импорт должен происходить **до** рендеринга компонентов React.

## Структура файлов переводов

Все файлы переводов (`ru.json`, `en.json`, `kz.json`) имеют одинаковую структуру с вложенными объектами:

```json
{
  "common": {
    "save": "Сохранить",
    "cancel": "Отмена"
  },
  "header": {
    "menu": {
      "home": "Главная",
      "services": "Услуги"
    }
  },
  "footer": {
    "description": "...",
    "company1": {
      "name": "...",
      "bin": "...",
      "address": "..."
    }
  }
}
```

### Основные разделы переводов:

- `common` - общие элементы интерфейса
- `header` - элементы шапки сайта
- `footer` - элементы подвала
- `hero` - главная страница
- `services` - страница услуг
- `auth` - авторизация и регистрация
- `profile` - профиль пользователя
- `support` - страница поддержки
- `reviews` - отзывы
- `privacy` - политика конфиденциальности
- `terms` - пользовательское соглашение
- `refund` - политика возврата средств
- `faq` - часто задаваемые вопросы

## Использование в компонентах

### Базовое использование

```typescript
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();
  
  return <h1>{t('header.menu.home')}</h1>;
}
```

### Доступ к объекту i18n

Для программного изменения языка:

```typescript
import { useTranslation } from 'react-i18next';

function LanguageSwitcher() {
  const { i18n } = useTranslation();
  
  const changeLanguage = (lng: string) => {
    i18n.changeLanguage(lng);
  };
  
  return (
    <button onClick={() => changeLanguage('en')}>
      English
    </button>
  );
}
```

### Пример из Header.tsx

```typescript
export const Header: React.FC<HeaderProps> = ({ onPageChange, currentPage }) => {
  const { t, i18n } = useTranslation();
  
  const menuItems = [
    { id: 'home', label: t('header.menu.home'), icon: Zap },
    { id: 'services', label: t('header.menu.services'), icon: Users },
    { id: 'reviews', label: t('header.menu.reviews'), icon: MessageCircle },
    { id: 'support', label: t('header.menu.support'), icon: Settings },
  ];
  
  const changeLanguage = (lng: string) => {
    i18n.changeLanguage(lng);
    setShowLanguageMenu(false);
  };
  
  // ...
};
```

## Переключение языка

### Реализация в Header

Компонент `Header` содержит селектор языка, который позволяет переключаться между:
- Русский (RU)
- Английский (EN)
- Казахский (KZ)

При изменении языка:
1. Вызывается `i18n.changeLanguage(lng)`
2. Язык сохраняется в `localStorage` (ключ `i18nextLng`)
3. Все компоненты автоматически обновляются с новыми переводами

## Хранение выбранного языка

Язык пользователя сохраняется в `localStorage` браузера:
- **Ключ**: `i18nextLng`
- **Значения**: `'ru'`, `'en'`, `'kz'`

При следующем посещении сайта язык автоматически восстанавливается из `localStorage`.

## Паттерны использования

### 1. Простые переводы

```typescript
{t('common.save')}           // "Сохранить"
{t('header.menu.home')}      // "Главная"
```

### 2. Вложенные объекты

```typescript
{t('footer.company1.name')}  // "ТОО \"White Trade\""
{t('footer.company1.bin')}   // "БИН 250140025178"
```

### 3. Динамические значения

i18next поддерживает интерполяцию (хотя в проекте используется редко):

```typescript
// В JSON: "welcome": "Добро пожаловать, {{name}}!"
{t('welcome', { name: 'Иван' })}
```

### 4. Множественные переводы в одном компоненте

```typescript
const { t } = useTranslation();

return (
  <div>
    <h1>{t('privacy.title')}</h1>
    <p>{t('privacy.subtitle')}</p>
    <p>{t('privacy.contactText')}</p>
  </div>
);
```

## Добавление новых переводов

### Шаг 1: Добавить ключ в русский файл

`src/locales/ru.json`:
```json
{
  "mySection": {
    "title": "Новый раздел",
    "description": "Описание раздела"
  }
}
```

### Шаг 2: Добавить переводы для других языков

`src/locales/en.json`:
```json
{
  "mySection": {
    "title": "New Section",
    "description": "Section description"
  }
}
```

`src/locales/kz.json`:
```json
{
  "mySection": {
    "title": "Жаңа бөлім",
    "description": "Бөлім сипаттамасы"
  }
}
```

### Шаг 3: Использовать в компоненте

```typescript
const { t } = useTranslation();

return <h1>{t('mySection.title')}</h1>;
```

## Важные замечания

### 1. Синхронизация файлов переводов

⚠️ **Важно**: Все три файла (`ru.json`, `en.json`, `kz.json`) должны иметь **одинаковую структуру ключей**. Если добавляется новый ключ в `ru.json`, его нужно добавить и в остальные файлы.

### 2. Именование ключей

Рекомендуется использовать точечную нотацию для вложенных объектов:
- ✅ `header.menu.home`
- ❌ `header_menu_home`

### 3. HTML в переводах

Так как `escapeValue: false`, можно использовать HTML в переводах, но это нужно делать осторожно:

```json
{
  "welcome": "Добро пожаловать на <strong>SMM Boost</strong>!"
}
```

### 4. Пробелы и форматирование

При использовании переводов с пробелами и ссылками:

```typescript
// В JSON:
{
  "contactText": "По вопросам конфиденциальности обращайтесь через форму обратной связи на странице",
  "contactTextLink": "Поддержка"
}

// В компоненте:
<p>
  {t('privacy.contactText')}{' '}
  <button onClick={...}>
    {t('privacy.contactTextLink')}
  </button>
</p>
```

## Отладка

### Включение режима отладки

В файле `src/lib/i18n.ts` можно включить отладку:

```typescript
.init({
  // ...
  debug: true,  // Включить отладку
  // ...
});
```

В консоли браузера будут выводиться предупреждения о недостающих переводах.

### Проверка текущего языка

```typescript
const { i18n } = useTranslation();
console.log(i18n.language);  // 'ru', 'en' или 'kz'
```

## Зависимости

Проект использует следующие npm-пакеты для i18n:

```json
{
  "dependencies": {
    "i18next": "^25.7.3",
    "i18next-browser-languagedetector": "^8.2.0",
    "react-i18next": "^16.5.0"
  }
}
```

- **i18next** - основная библиотека интернационализации
- **i18next-browser-languagedetector** - автоматическое определение языка браузера
- **react-i18next** - интеграция с React

## Примеры использования в проекте

### Компоненты, использующие i18n:

- `Header.tsx` - меню навигации, переключатель языка
- `Footer.tsx` - информация в подвале
- `Hero.tsx` - главная страница
- `ServicesGrid.tsx` - сетка услуг
- `ServiceDetail.tsx` - детали услуги
- `AuthModal.tsx` - модальное окно авторизации
- `ProfilePage.tsx` - страница профиля
- `SupportPage.tsx` - страница поддержки
- `PrivacyPage.tsx` - политика конфиденциальности
- `TermsPage.tsx` - пользовательское соглашение
- `RefundPage.tsx` - политика возврата средств
- `FAQPage.tsx` - часто задаваемые вопросы
- И другие компоненты...

## Резюме

Система i18n в проекте настроена следующим образом:

1. ✅ Автоматическое определение языка из браузера или localStorage
2. ✅ Сохранение выбранного языка в localStorage
3. ✅ Поддержка трех языков: русский, английский, казахский
4. ✅ Простое использование через хук `useTranslation()`
5. ✅ Единая структура файлов переводов
6. ✅ Русский язык как fallback при отсутствии перевода

Система полностью интегрирована во все компоненты приложения и обеспечивает удобную многоязычную поддержку.


